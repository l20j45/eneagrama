import{$ as er,A as zr,B as Wr,C as Jr,D as Kr,E as Yt,F as Qr,G as Yr,H as G,I as j,J as Xt,K as ge,L as Xr,M as oe,N as J,O as ct,P as je,Q as Zr,R as ei,T as H,U as K,V as Zt,W as ti,Y as ri,a as Rr,b as $r,c as Nr,d as Ur,e as ot,f as Ve,g as te,h as re,i as ie,j as Lr,k as Br,l as Gr,m as se,n as F,o as Qt,r as Hr,s as qr,t as Ie,u as at,v as R,w,x as lt,y as ne,z as W}from"./chunk-K57ZVTLU.js";import{b as ii,c as si,f as Us,g as ni}from"./chunk-LJ5XHLMQ.js";import{a as E,b as A,d as B,f as $s,g as Ns,h}from"./chunk-FK42CRUA.js";var Li=B(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});var gr=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};mr.default=gr});var vr=B(Be=>{"use strict";var Bi=Be&&Be.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Be,"__esModule",{value:!0});var An=Bi((ni(),Ns(Us))),Sn=Bi(Li()),_r=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=An.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch,s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(n=>h(this,null,function*(){var o,a,l;let c=null,u=null,d=null,p=n.status,f=n.statusText;if(n.ok){if(this.method!=="HEAD"){let S=yield n.text();S===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=S:u=JSON.parse(S))}let _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=n.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,p=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{let _=yield n.text();try{c=JSON.parse(_),Array.isArray(c)&&n.status===404&&(u=[],c=null,p=200,f="OK")}catch{n.status===404&&_===""?(p=204,f="No Content"):c={message:_}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new Sn.default(c)}return{error:c,data:u,count:d,status:p,statusText:f}}));return this.shouldThrowOnError||(s=s.catch(n=>{var o,a,l;return{error:{message:`${(o=n?.name)!==null&&o!==void 0?o:"FetchError"}: ${n?.message}`,details:`${(a=n?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=n?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}};Be.default=_r});var br=B(Ge=>{"use strict";var xn=Ge&&Ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ge,"__esModule",{value:!0});var kn=xn(vr()),yr=class extends kn.default{select(e){let t=!1,r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){let o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){let n=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:o="text"}={}){var a;let l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ge.default=yr});var At=B(He=>{"use strict";var Dn=He&&He.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(He,"__esModule",{value:!0});var On=Dn(br()),wr=class extends On.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");let o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};He.default=wr});var Er=B(ze=>{"use strict";var Tn=ze&&ze.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ze,"__esModule",{value:!0});var qe=Tn(At()),Cr=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){let s=t?"HEAD":"GET",n=!1,o=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new qe.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let s="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){let o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){let a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new qe.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){let o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){let c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new qe.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new qe.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new qe.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ze.default=Cr});var Gi=B(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.version=void 0;St.version="0.0.0-automated"});var Hi=B(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.DEFAULT_HEADERS=void 0;var Pn=Gi();xt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Pn.version}`}});var zi=B(We=>{"use strict";var qi=We&&We.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(We,"__esModule",{value:!0});var Vn=qi(Er()),In=qi(At()),jn=Hi(),Ar=class i{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},jn.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){let t=new URL(`${this.url}/${e}`);return new Vn.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:n}={}){let o,a=new URL(`${this.url}/rpc/${e}`),l;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(o="POST",l=t);let c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new In.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};We.default=Ar});var Xi=B(k=>{"use strict";var Je=k&&k.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(k,"__esModule",{value:!0});k.PostgrestBuilder=k.PostgrestTransformBuilder=k.PostgrestFilterBuilder=k.PostgrestQueryBuilder=k.PostgrestClient=void 0;var Wi=Je(zi());k.PostgrestClient=Wi.default;var Ji=Je(Er());k.PostgrestQueryBuilder=Ji.default;var Ki=Je(At());k.PostgrestFilterBuilder=Ki.default;var Qi=Je(br());k.PostgrestTransformBuilder=Qi.default;var Yi=Je(vr());k.PostgrestBuilder=Yi.default;k.default={PostgrestClient:Wi.default,PostgrestQueryBuilder:Ji.default,PostgrestFilterBuilder:Ki.default,PostgrestTransformBuilder:Qi.default,PostgrestBuilder:Yi.default}});var pi=(()=>{let e=class e{constructor(r,s){this._renderer=r,this._elementRef=s,this.onChange=n=>{},this.onTouched=()=>{}}setProperty(r,s){this._renderer.setProperty(this._elementRef.nativeElement,r,s)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(s){return new(s||e)(w(lt),w(at))},e.\u0275dir=F({type:e});let i=e;return i})(),gi=(()=>{let e=class e extends pi{};e.\u0275fac=(()=>{let r;return function(n){return(r||(r=Hr(e)))(n||e)}})(),e.\u0275dir=F({type:e,features:[W]});let i=e;return i})(),or=new ie("");var Ls={provide:or,useExisting:Ve(()=>vt),multi:!0};function Bs(){let i=Zt()?Zt().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var Gs=new ie(""),vt=(()=>{let e=class e extends pi{constructor(r,s,n){super(r,s),this._compositionMode=n,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Bs())}writeValue(r){let s=r??"";this.setProperty("value",s)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(s){return new(s||e)(w(lt),w(at),w(Gs,8))},e.\u0275dir=F({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(s,n){s&1&&ge("input",function(a){return n._handleInput(a.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(a){return n._compositionEnd(a.target.value)})},features:[je([Ls]),W]});let i=e;return i})();function Q(i){return i==null||(typeof i=="string"||Array.isArray(i))&&i.length===0}function mi(i){return i!=null&&typeof i.length=="number"}var _i=new ie(""),vi=new ie(""),Hs=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,T=class{static min(e){return qs(e)}static max(e){return zs(e)}static required(e){return Ws(e)}static requiredTrue(e){return Js(e)}static email(e){return Ks(e)}static minLength(e){return Qs(e)}static maxLength(e){return Ys(e)}static pattern(e){return Xs(e)}static nullValidator(e){return yi(e)}static compose(e){return Si(e)}static composeAsync(e){return ki(e)}};function qs(i){return e=>{if(Q(e.value)||Q(i))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<i?{min:{min:i,actual:e.value}}:null}}function zs(i){return e=>{if(Q(e.value)||Q(i))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>i?{max:{max:i,actual:e.value}}:null}}function Ws(i){return Q(i.value)?{required:!0}:null}function Js(i){return i.value===!0?null:{required:!0}}function Ks(i){return Q(i.value)||Hs.test(i.value)?null:{email:!0}}function Qs(i){return e=>Q(e.value)||!mi(e.value)?null:e.value.length<i?{minlength:{requiredLength:i,actualLength:e.value.length}}:null}function Ys(i){return e=>mi(e.value)&&e.value.length>i?{maxlength:{requiredLength:i,actualLength:e.value.length}}:null}function Xs(i){if(!i)return yi;let e,t;return typeof i=="string"?(t="",i.charAt(0)!=="^"&&(t+="^"),t+=i,i.charAt(i.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=i.toString(),e=i),r=>{if(Q(r.value))return null;let s=r.value;return e.test(s)?null:{pattern:{requiredPattern:t,actualValue:s}}}}function yi(i){return null}function bi(i){return i!=null}function wi(i){return ei(i)?$r(i):i}function Ci(i){let e={};return i.forEach(t=>{e=t!=null?E(E({},e),t):e}),Object.keys(e).length===0?null:e}function Ei(i,e){return e.map(t=>t(i))}function Zs(i){return!i.validate}function Ai(i){return i.map(e=>Zs(e)?e:t=>e.validate(t))}function Si(i){if(!i)return null;let e=i.filter(bi);return e.length==0?null:function(t){return Ci(Ei(t,e))}}function xi(i){return i!=null?Si(Ai(i)):null}function ki(i){if(!i)return null;let e=i.filter(bi);return e.length==0?null:function(t){let r=Ei(t,e).map(wi);return Ur(r).pipe(Nr(Ci))}}function Di(i){return i!=null?ki(Ai(i)):null}function oi(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function Oi(i){return i._rawValidators}function Ti(i){return i._rawAsyncValidators}function tr(i){return i?Array.isArray(i)?i:[i]:[]}function ht(i,e){return Array.isArray(i)?i.includes(e):i===e}function ai(i,e){let t=tr(e);return tr(i).forEach(s=>{ht(t,s)||t.push(s)}),t}function li(i,e){return tr(e).filter(t=>!ht(i,t))}var dt=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=xi(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Di(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},ve=class extends dt{get formDirective(){return null}get path(){return null}},ye=class extends dt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},ft=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},en={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Go=A(E({},en),{"[class.ng-submitted]":"isSubmitted"}),Pi=(()=>{let e=class e extends ft{constructor(r){super(r)}};e.\u0275fac=function(s){return new(s||e)(w(ye,2))},e.\u0275dir=F({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(s,n){s&2&&Yt("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[W]});let i=e;return i})(),Vi=(()=>{let e=class e extends ft{constructor(r){super(r)}};e.\u0275fac=function(s){return new(s||e)(w(ve,10))},e.\u0275dir=F({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(s,n){s&2&&Yt("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)("ng-submitted",n.isSubmitted)},features:[W]});let i=e;return i})();var Me="VALID",ut="INVALID",me="PENDING",Fe="DISABLED",Y=class{},pt=class extends Y{constructor(e,t){super(),this.value=e,this.source=t}},Re=class extends Y{constructor(e,t){super(),this.pristine=e,this.source=t}},$e=class extends Y{constructor(e,t){super(),this.touched=e,this.source=t}},_e=class extends Y{constructor(e,t){super(),this.status=e,this.source=t}},rr=class extends Y{constructor(e){super(),this.source=e}},ir=class extends Y{constructor(e){super(),this.source=e}};function ar(i){return(yt(i)?i.validators:i)||null}function tn(i){return Array.isArray(i)?xi(i):i||null}function lr(i,e){return(yt(e)?e.asyncValidators:i)||null}function rn(i){return Array.isArray(i)?Di(i):i||null}function yt(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function Ii(i,e,t){let r=i.controls;if(!(e?Object.keys(r):r).length)throw new ot(1e3,"");if(!r[t])throw new ot(1001,"")}function ji(i,e,t){i._forEachChild((r,s)=>{if(t[s]===void 0)throw new ot(1002,"")})}var be=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=H(()=>this.statusReactive()),this.statusReactive=ne(void 0),this._pristine=H(()=>this.pristineReactive()),this.pristineReactive=ne(!0),this._touched=H(()=>this.touchedReactive()),this.touchedReactive=ne(!1),this._events=new Rr,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return K(this.statusReactive)}set status(e){K(()=>this.statusReactive.set(e))}get valid(){return this.status===Me}get invalid(){return this.status===ut}get pending(){return this.status==me}get disabled(){return this.status===Fe}get enabled(){return this.status!==Fe}get pristine(){return K(this.pristineReactive)}set pristine(e){K(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return K(this.touchedReactive)}set touched(e){K(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(ai(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(ai(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(li(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(li(e,this._rawAsyncValidators))}hasValidator(e){return ht(this._rawValidators,e)}hasAsyncValidator(e){return ht(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(A(E({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new $e(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(s=>{s.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new $e(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(A(E({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Re(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(s=>{s.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Re(!0,r))}markAsPending(e={}){this.status=me;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _e(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(A(E({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Fe,this.errors=null,this._forEachChild(s=>{s.disable(A(E({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new pt(this.value,r)),this._events.next(new _e(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(A(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(s=>s(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Me,this._forEachChild(r=>{r.enable(A(E({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(A(E({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Me||this.status===me)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new pt(this.value,t)),this._events.next(new _e(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(A(E({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fe:Me}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=me,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=wi(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(s=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(s,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,s)=>r&&r._find(s),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new _e(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Ie,this.statusChanges=new Ie}_calculateStatus(){return this._allControlsDisabled()?Fe:this.errors?ut:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(me)?me:this._anyControlsHaveStatus(ut)?ut:Me}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),s=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),s&&this._events.next(new Re(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new $e(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){yt(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=tn(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=rn(this._rawAsyncValidators)}},gt=class extends be{constructor(e,t,r){super(ar(t),lr(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){ji(this,!0,e),Object.keys(e).forEach(r=>{Ii(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let s=this.controls[r];s&&s.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,s)=>{r.reset(e?e[s]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,s)=>((r.enabled||this.disabled)&&(t[s]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((s,n)=>{r=t(r,s,n)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var sr=class extends gt{};var cr=new ie("CallSetDisabledState",{providedIn:"root",factory:()=>bt}),bt="always";function sn(i,e){return[...e.path,i]}function ci(i,e,t=bt){ur(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),on(i,e),ln(i,e),an(i,e),nn(i,e)}function ui(i,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),_t(i,e),i&&(e._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function mt(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function nn(i,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function ur(i,e){let t=Oi(i);e.validator!==null?i.setValidators(oi(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let r=Ti(i);e.asyncValidator!==null?i.setAsyncValidators(oi(r,e.asyncValidator)):typeof r=="function"&&i.setAsyncValidators([r]);let s=()=>i.updateValueAndValidity();mt(e._rawValidators,s),mt(e._rawAsyncValidators,s)}function _t(i,e){let t=!1;if(i!==null){if(e.validator!==null){let s=Oi(i);if(Array.isArray(s)&&s.length>0){let n=s.filter(o=>o!==e.validator);n.length!==s.length&&(t=!0,i.setValidators(n))}}if(e.asyncValidator!==null){let s=Ti(i);if(Array.isArray(s)&&s.length>0){let n=s.filter(o=>o!==e.asyncValidator);n.length!==s.length&&(t=!0,i.setAsyncValidators(n))}}}let r=()=>{};return mt(e._rawValidators,r),mt(e._rawAsyncValidators,r),t}function on(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&Mi(i,e)})}function an(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&Mi(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function Mi(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function ln(i,e){let t=(r,s)=>{e.valueAccessor.writeValue(r),s&&e.viewToModelUpdate(r)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function cn(i,e){i==null,ur(i,e)}function un(i,e){return _t(i,e)}function hn(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dn(i){return Object.getPrototypeOf(i.constructor)===gi}function fn(i,e){i._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function pn(i,e){if(!e)return null;Array.isArray(e);let t,r,s;return e.forEach(n=>{n.constructor===vt?t=n:dn(n)?r=n:s=n}),s||r||t||null}function gn(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function hi(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function di(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var x=class extends be{constructor(e=null,t,r){super(ar(t),lr(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),yt(t)&&(t.nonNullable||t.initialValueIsDefault)&&(di(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hi(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hi(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){di(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var mn=i=>i instanceof x;var Fi=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275dir=F({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let i=e;return i})();var _n={provide:or,useExisting:Ve(()=>hr),multi:!0};var vn=(()=>{let e=class e{constructor(){this._accessors=[]}add(r,s){this._accessors.push([r,s])}remove(r){for(let s=this._accessors.length-1;s>=0;--s)if(this._accessors[s][1]===r){this._accessors.splice(s,1);return}}select(r){this._accessors.forEach(s=>{this._isSameGroup(s,r)&&s[1]!==r&&s[1].fireUncheck(r.value)})}_isSameGroup(r,s){return r[0].control?r[0]._parent===s._control._parent&&r[1].name===s.name:!1}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),hr=(()=>{let e=class e extends gi{constructor(r,s,n,o){super(r,s),this._registry=n,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=Br(cr,{optional:!0})??bt}ngOnInit(){this._control=this._injector.get(ye),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(r){this._state=r===this.value,this.setProperty("checked",this._state)}registerOnChange(r){this._fn=r,this.onChange=()=>{r(this.value),this._registry.select(this)}}setDisabledState(r){(this.setDisabledStateFired||r||this.callSetDisabledState==="whenDisabledForLegacyCode")&&this.setProperty("disabled",r),this.setDisabledStateFired=!0}fireUncheck(r){this.writeValue(r)}_checkName(){this.name&&this.formControlName&&(this.name,this.formControlName),!this.name&&this.formControlName&&(this.name=this.formControlName)}};e.\u0275fac=function(s){return new(s||e)(w(lt),w(at),w(vn),w(qr))},e.\u0275dir=F({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(s,n){s&1&&ge("change",function(){return n.onChange()})("blur",function(){return n.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[je([_n]),W]});let i=e;return i})();var Ri=new ie("");var yn={provide:ve,useExisting:Ve(()=>dr)},dr=(()=>{let e=class e extends ve{get submitted(){return K(this._submittedReactive)}set submitted(r){this._submittedReactive.set(r)}constructor(r,s,n){super(),this.callSetDisabledState=n,this._submitted=H(()=>this._submittedReactive()),this._submittedReactive=ne(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ie,this._setValidators(r),this._setAsyncValidators(s)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(_t(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let s=this.form.get(r.path);return ci(s,r,this.callSetDisabledState),s.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),s}getControl(r){return this.form.get(r.path)}removeControl(r){ui(r.control||null,r,!1),gn(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,s){this.form.get(r.path).setValue(s)}onSubmit(r){return this._submittedReactive.set(!0),fn(this.form,this.directives),this.ngSubmit.emit(r),this.form._events.next(new rr(this.control)),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this._submittedReactive.set(!1),this.form._events.next(new ir(this.form))}_updateDomValue(){this.directives.forEach(r=>{let s=r.control,n=this.form.get(r.path);s!==n&&(ui(s||null,r),mn(n)&&(ci(n,r,this.callSetDisabledState),r.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let s=this.form.get(r.path);cn(s,r),s.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let s=this.form.get(r.path);s&&un(s,r)&&s.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ur(this.form,this),this._oldForm&&_t(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(s){return new(s||e)(w(_i,10),w(vi,10),w(cr,8))},e.\u0275dir=F({type:e,selectors:[["","formGroup",""]],hostBindings:function(s,n){s&1&&ge("submit",function(a){return n.onSubmit(a)})("reset",function(){return n.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[je([yn]),W,Qt]});let i=e;return i})();var bn={provide:ye,useExisting:Ve(()=>fr)},fr=(()=>{let e=class e extends ye{set isDisabled(r){}constructor(r,s,n,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Ie,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(s),this._setAsyncValidators(n),this.valueAccessor=pn(this,o)}ngOnChanges(r){this._added||this._setUpControl(),hn(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return sn(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(s){return new(s||e)(w(ve,13),w(_i,10),w(vi,10),w(or,10),w(Ri,8))},e.\u0275dir=F({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[je([bn]),W,Qt]});let i=e;return i})();var wn=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=se({type:e}),e.\u0275inj=re({});let i=e;return i})(),nr=class extends be{constructor(e,t,r){super(ar(t),lr(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let s=this._adjustIndex(e);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),t&&(this.controls.splice(s,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){ji(this,!1,e),e.forEach((r,s)=>{Ii(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,s)=>{r.reset(e[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function fi(i){return!!i&&(i.asyncValidators!==void 0||i.validators!==void 0||i.updateOn!==void 0)}var $i=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,s=null){let n=this._reduceControls(r),o={};return fi(s)?o=s:s!==null&&(o.validators=s.validator,o.asyncValidators=s.asyncValidator),new gt(n,o)}record(r,s=null){let n=this._reduceControls(r);return new sr(n,s)}control(r,s,n){let o={};return this.useNonNullable?(fi(s)?o=s:(o.validators=s,o.asyncValidators=n),new x(r,A(E({},o),{nonNullable:!0}))):new x(r,s,n)}array(r,s,n){let o=r.map(a=>this._createControl(a));return new nr(o,s,n)}_reduceControls(r){let s={};return Object.keys(r).forEach(n=>{s[n]=this._createControl(r[n])}),s}_createControl(r){if(r instanceof x)return r;if(r instanceof be)return r;if(Array.isArray(r)){let s=r[0],n=r.length>1?r[1]:null,o=r.length>2?r[2]:null;return this.control(s,n,o)}else return this.control(r)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Ni=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Ri,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:cr,useValue:r.callSetDisabledState??bt}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=se({type:e}),e.\u0275inj=re({imports:[wn]});let i=e;return i})();var Ui=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};var Ue=class extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}},wt=class extends Ue{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Ct=class extends Ue{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Et=class extends Ue{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}},pr=function(i){return i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2",i}(pr||{});var En=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Le=class{constructor(e,{headers:t={},customFetch:r,region:s=pr.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Ui(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return En(this,void 0,void 0,function*(){try{let{headers:s,method:n,body:o}=t,a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));let u=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(y=>{throw new wt(y)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new Ct(u);if(!u.ok)throw new Et(u);let p=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield u.json():p==="application/octet-stream"?f=yield u.blob():p==="text/event-stream"?f=u:p==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}};var Zi=$s(Xi(),1),{PostgrestClient:es,PostgrestQueryBuilder:ca,PostgrestFilterBuilder:ua,PostgrestTransformBuilder:ha,PostgrestBuilder:da}=Zi.default;var ts="2.10.2";var rs={"X-Client-Info":`realtime-js/${ts}`},is="1.0.0",kt=1e4,ss=1e3,we=function(i){return i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed",i}(we||{}),P=function(i){return i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving",i}(P||{}),V=function(i){return i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token",i}(V||{}),Sr=function(i){return i.websocket="websocket",i}(Sr||{}),ae=function(i){return i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed",i}(ae||{});var Dt=class{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let s=t.getUint8(1),n=t.getUint8(2),o=this.HEADER_LENGTH+2,a=r.decode(e.slice(o,o+s));o=o+s;let l=r.decode(e.slice(o,o+n));o=o+n;let c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}};var Ce=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var b=function(i){return i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange",i}(b||{}),kr=(i,e,t={})=>{var r;let s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((n,o)=>(n[o]=Mn(o,i,e,s),n),{})},Mn=(i,e,t,r)=>{let s=e.find(a=>a.name===i),n=s?.type,o=t[i];return n&&!r.includes(n)?ns(n,o):xr(o)},ns=(i,e)=>{if(i.charAt(0)==="_"){let t=i.slice(1,i.length);return Nn(e,t)}switch(i){case b.bool:return Fn(e);case b.float4:case b.float8:case b.int2:case b.int4:case b.int8:case b.numeric:case b.oid:return Rn(e);case b.json:case b.jsonb:return $n(e);case b.timestamp:return Un(e);case b.abstime:case b.date:case b.daterange:case b.int4range:case b.int8range:case b.money:case b.reltime:case b.text:case b.time:case b.timestamptz:case b.timetz:case b.tsrange:case b.tstzrange:return xr(e);default:return xr(e)}},xr=i=>i,Fn=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Rn=i=>{if(typeof i=="string"){let e=parseFloat(i);if(!Number.isNaN(e))return e}return i},$n=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Nn=(i,e)=>{if(typeof i!="string")return i;let t=i.length-1,r=i[t];if(i[0]==="{"&&r==="}"){let n,o=i.slice(1,t);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(a=>ns(e,a))}return i},Un=i=>typeof i=="string"?i.replace(" ","T"):i,Ot=i=>{let e=i;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};var Ee=class{constructor(e,t,r={},s=kt){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}};var Ke=class i{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=i.syncState(this.state,s,n,o),this.pendingDiffs.forEach(l=>{this.state=i.syncDiff(this.state,l,n,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{let{onJoin:n,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=i.syncDiff(this.state,s,n,o),a())}),this.onJoin((s,n,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:n,newPresences:o})}),this.onLeave((s,n,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){let n=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(n,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{let d=n[c];if(d){let p=u.map(v=>v.presence_ref),f=d.map(v=>v.presence_ref),y=u.filter(v=>f.indexOf(v.presence_ref)<0),_=d.filter(v=>p.indexOf(v.presence_ref)<0);y.length>0&&(a[c]=y),_.length>0&&(l[c]=_)}else a[c]=u}),this.syncDiff(n,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){let{joins:n,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(a,l)=>{var c;let u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){let d=e[a].map(f=>f.presence_ref),p=u.filter(f=>d.indexOf(f.presence_ref)<0);e[a].unshift(...p)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;let u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{let s=e[r];return"metas"in s?t[r]=s.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Qe=class i{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=P.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ee(this,V.join,this.params,this.timeout),this.rejoinTimer=new Ce(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=P.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=P.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=P.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=P.errored,this.rejoinTimer.scheduleTimeout())}),this._on(V.reply,{},(s,n)=>{this._trigger(this._replyEventName(n),s)}),this.presence=new Ke(this),this.broadcastEndpointURL=Ot(this.socket.endPoint)+"/api/broadcast"}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:o,private:a}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));let l={},c={broadcast:n,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:u})=>{var d;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{let p=this.bindings.postgres_changes,f=(d=p?.length)!==null&&d!==void 0?d:0,y=[];for(let _=0;_<f;_++){let v=p[_],{filter:{event:S,schema:U,table:L,filter:I}}=v,D=u&&u[_];if(D&&D.event===S&&D.schema===U&&D.table===L&&D.filter===I)y.push(Object.assign(Object.assign({},v),{id:D.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(r){return h(this,arguments,function*(e,t={}){return yield this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)})}untrack(){return h(this,arguments,function*(e={}){return yield this.send({type:"presence",event:"untrack"},e)})}on(e,t,r){return this._on(e,t,r)}send(r){return h(this,arguments,function*(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){let{event:o,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a}]})};try{let c=yield this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return yield(n=c.body)===null||n===void 0?void 0:n.cancel(),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,c;let u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=P.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(V.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let s=new Ee(this,V.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_fetchWithTimeout(e,t,r){return h(this,null,function*(){let s=new AbortController,n=setTimeout(()=>s.abort(),r),o=yield this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(n),o})}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ee(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,n;let o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=V;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,t,r);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var y,_,v;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(_=f.filter)===null||_===void 0?void 0:_.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(p,r)):(n=this.bindings[o])===null||n===void 0||n.filter(f=>{var y,_,v,S,U,L;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let I=f.id,D=(y=f.filter)===null||y===void 0?void 0:y.event;return I&&((_=t.ids)===null||_===void 0?void 0:_.includes(I))&&(D==="*"||D?.toLocaleLowerCase()===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{let I=(U=(S=f?.filter)===null||S===void 0?void 0:S.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return I==="*"||I===((L=t?.event)===null||L===void 0?void 0:L.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let y=p.data,{schema:_,table:v,commit_timestamp:S,type:U,errors:L}=y;p=Object.assign(Object.assign({},{schema:_,table:v,commit_timestamp:S,eventType:U,new:{},old:{},errors:L}),this._getPayloadRecords(y))}f.callback(p,r)})}_isClosed(){return this.state===P.closed}_isJoined(){return this.state===P.joined}_isJoining(){return this.state===P.joining}_isLeaving(){return this.state===P.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let s=e.toLocaleLowerCase(),n={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var n;return!(((n=s.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===r&&i.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(V.close,{},e)}_onError(e){this._on(V.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=P.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=kr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=kr(e.columns,e.old_record)),t}};var Bn=()=>{},Gn=typeof WebSocket<"u",Ye=class{constructor(e,t){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=rs,this.params={},this.timeout=kt,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Bn,this.conn=null,this.sendBuffer=[],this.serializer=new Dt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>import("./chunk-BX7VDEVO.js").then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Sr.websocket}`,this.httpEndpoint=Ot(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let s=(r=t?.params)===null||r===void 0?void 0:r.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t?.encode?t.encode:(n,o)=>o(JSON.stringify(n)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ce(()=>h(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Gn){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Dr(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),import("./chunk-266KHGQI.js").then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(e){return h(this,null,function*(){let t=yield e.unsubscribe();return this.channels.length===0&&this.disconnect(),t})}removeAllChannels(){return h(this,null,function*(){let e=yield Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e})}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case we.connecting:return ae.Connecting;case we.open:return ae.Open;case we.closing:return ae.Closing;default:return ae.Closed}}isConnected(){return this.connectionState()===ae.Open}channel(e,t={config:{}}){let r=new Qe(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:s,ref:n}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${n})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(V.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:is}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:n,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===n?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,n),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(s,n,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(V.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;let r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ss,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}};var Dr=class{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=we.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}};var Ae=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function C(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Tt=class extends Ae{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}},le=class extends Ae{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};var Hn=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Vt=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},os=()=>Hn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-BX7VDEVO.js")).Response:Response}),Pt=i=>{if(Array.isArray(i))return i.map(t=>Pt(t));if(typeof i=="function"||i!==Object(i))return i;let e={};return Object.entries(i).forEach(([t,r])=>{let s=t.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));e[s]=Pt(r)}),e};var ce=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Or=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),qn=(i,e,t)=>ce(void 0,void 0,void 0,function*(){let r=yield os();i instanceof r&&!t?.noResolveJson?i.json().then(s=>{e(new Tt(Or(s),i.status||500))}).catch(s=>{e(new le(Or(s),s))}):e(new le(Or(i),i))}),zn=(i,e,t,r)=>{let s={method:i,headers:e?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function Xe(i,e,t,r,s,n){return ce(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(t,zn(e,r,s,n)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>qn(l,a,r))})})}function Se(i,e,t,r){return ce(this,void 0,void 0,function*(){return Xe(i,"GET",e,t,r)})}function $(i,e,t,r,s){return ce(this,void 0,void 0,function*(){return Xe(i,"POST",e,r,s,t)})}function as(i,e,t,r,s){return ce(this,void 0,void 0,function*(){return Xe(i,"PUT",e,r,s,t)})}function ls(i,e,t,r){return ce(this,void 0,void 0,function*(){return Xe(i,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function It(i,e,t,r,s){return ce(this,void 0,void 0,function*(){return Xe(i,"DELETE",e,r,s,t)})}var O=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Wn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},jt=class{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Vt(s)}uploadOrUpdate(e,t,r,s){return O(this,void 0,void 0,function*(){try{let n,o=Object.assign(Object.assign({},cs),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)}),l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),n.append("",r),l&&n.append("metadata",this.encodeMetadata(l))):typeof FormData<"u"&&r instanceof FormData?(n=r,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l))):(n=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));let c=this._removeEmptyFolders(t),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:n,headers:a},o?.duplex?{duplex:o.duplex}:{})),p=yield d.json();return d.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(n){if(C(n))return{data:null,error:n};throw n}})}upload(e,t,r){return O(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return O(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l,c=Object.assign({upsert:cs.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);let d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),p=yield d.json();return d.ok?{data:{path:n,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(C(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return O(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");let n=yield $(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new Ae("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}update(e,t,r){return O(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return O(this,void 0,void 0,function*(){try{return{data:yield $(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}copy(e,t,r){return O(this,void 0,void 0,function*(){try{return{data:{path:(yield $(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return O(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),n=yield $(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return O(this,void 0,void 0,function*(){try{let s=yield $(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}download(e,t){return O(this,void 0,void 0,function*(){let s=typeof t?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(t?.transform||{}),o=n?`?${n}`:"";try{let a=this._getFinalPath(e);return{data:yield(yield Se(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(C(a))return{data:null,error:a};throw a}})}info(e){return O(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let r=yield Se(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Pt(r),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}exists(e){return O(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield ls(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(C(r)&&r instanceof le){let s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){let r=this._getFinalPath(e),s=[],n=t?.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&s.push(n);let a=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return O(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}})}list(e,t,r){return O(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},Wn),t),{prefix:e||""});return{data:yield $(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(C(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};var us="2.7.0";var hs={"X-Client-Info":`storage-js/${us}`};var xe=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Mt=class{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},hs),t),this.fetch=Vt(r)}listBuckets(){return xe(this,void 0,void 0,function*(){try{return{data:yield Se(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(C(e))return{data:null,error:e};throw e}})}getBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield Se(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return xe(this,void 0,void 0,function*(){try{return{data:yield $(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return xe(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(C(r))return{data:null,error:r};throw r}})}emptyBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield $(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}})}deleteBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}})}};var Ze=class extends Mt{constructor(e,t={},r){super(e,t,r)}from(e){return new jt(this.url,this.headers,e,this.fetch)}};var ds="2.45.4";var et="";typeof Deno<"u"?et="deno":typeof document<"u"?et="web":typeof navigator<"u"&&navigator.product==="ReactNative"?et="react-native":et="node";var Jn={"X-Client-Info":`supabase-js-${et}/${ds}`},fs={headers:Jn},ps={schema:"public"},gs={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ms={};ni();var Kn=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},Qn=i=>{let e;return i?e=i:typeof fetch>"u"?e=ii:e=fetch,(...t)=>e(...t)},Yn=()=>typeof Headers>"u"?si:Headers,_s=(i,e,t)=>{let r=Qn(t),s=Yn();return(n,o)=>Kn(void 0,void 0,void 0,function*(){var a;let l=(a=yield e())!==null&&a!==void 0?a:i,c=new s(o?.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(n,Object.assign(Object.assign({},o),{headers:c}))})};var Xn=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})};function vs(i){return i.replace(/\/$/,"")}function ys(i,e){let{db:t,auth:r,realtime:s,global:n}=i,{db:o,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),n),accessToken:()=>Xn(this,void 0,void 0,function*(){return""})};return i.accessToken?u.accessToken=i.accessToken:delete u.accessToken,u}function bs(i){return Math.round(Date.now()/1e3)+i}function ws(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}var M=()=>typeof document<"u",ue={tested:!1,writable:!1},X=()=>{if(!M())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ue.tested)return ue.writable;let i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),ue.tested=!0,ue.writable=!0}catch{ue.tested=!0,ue.writable=!1}return ue.writable};function Ft(i){let e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,n)=>{e[n]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}var Rt=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Cs=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Z=(i,e,t)=>h(void 0,null,function*(){yield i.setItem(e,JSON.stringify(t))}),rt=(i,e)=>h(void 0,null,function*(){let t=yield i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}}),$t=(i,e)=>h(void 0,null,function*(){yield i.removeItem(e)});function Zn(i){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="",r,s,n,o,a,l,c,u=0;for(i=i.replace("-","+").replace("_","/");u<i.length;)o=e.indexOf(i.charAt(u++)),a=e.indexOf(i.charAt(u++)),l=e.indexOf(i.charAt(u++)),c=e.indexOf(i.charAt(u++)),r=o<<2|a>>4,s=(a&15)<<4|l>>2,n=(l&3)<<6|c,t=t+String.fromCharCode(r),l!=64&&s!=0&&(t=t+String.fromCharCode(s)),c!=64&&n!=0&&(t=t+String.fromCharCode(n));return t}var tt=class i{constructor(){this.promise=new i.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}};tt.promiseConstructor=Promise;function Tr(i){let e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=i.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");let r=t[1];return JSON.parse(Zn(r))}function Es(i){return h(this,null,function*(){return yield new Promise(e=>{setTimeout(()=>e(null),i)})})}function As(i,e){return new Promise((r,s)=>{h(this,null,function*(){for(let n=0;n<1/0;n++)try{let o=yield i(n);if(!e(n,null,o)){r(o);return}}catch(o){if(!e(n,o)){s(o);return}}})})}function eo(i){return("0"+i.toString(16)).substr(-2)}function he(){let e=new Uint32Array(56);if(typeof crypto>"u"){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length,s="";for(let n=0;n<56;n++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,eo).join("")}function to(i){return h(this,null,function*(){let t=new TextEncoder().encode(i),r=yield crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(n=>String.fromCharCode(n)).join("")})}function ro(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function de(i){return h(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;let t=yield to(i);return ro(t)})}var it=class extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}};function g(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}var Nt=class extends it{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}};function Ss(i){return g(i)&&i.name==="AuthApiError"}var ke=class extends it{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},q=class extends it{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}},z=class extends q{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}},De=class extends q{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}},fe=class extends q{constructor(e){super(e,"AuthInvalidCredentialsError",400)}},pe=class extends q{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},st=class extends q{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Oe=class extends q{constructor(e,t){super(e,"AuthRetryableFetchError",t)}};function Lt(i){return g(i)&&i.name==="AuthRetryableFetchError"}var Ut=class extends q{constructor(e,t,r){super(e,"AuthWeakPasswordError",t),this.reasons=r}};var io=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(i);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(i,r[s])&&(t[r[s]]=i[r[s]]);return t},Te=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),so=[502,503,504];function xs(i){return h(this,null,function*(){if(!Cs(i))throw new Oe(Te(i),0);if(so.includes(i.status))throw new Oe(Te(i),i.status);let e;try{e=yield i.json()}catch(t){throw new ke(Te(t),t)}throw typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)?new Ut(Te(e),i.status,e.weak_password.reasons):new Nt(Te(e),i.status||500)})}var no=(i,e,t,r)=>{let s={method:i,headers:e?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function m(i,e,t,r){return h(this,null,function*(){var s;let n=Object.assign({},r?.headers);r?.jwt&&(n.Authorization=`Bearer ${r.jwt}`);let o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield oo(i,e,t+a,{headers:n,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}})}function oo(i,e,t,r,s,n){return h(this,null,function*(){let o=no(e,r,s,n),a;try{a=yield i(t,o)}catch(l){throw console.error(l),new Oe(Te(l),0)}if(a.ok||(yield xs(a)),r?.noResolveJson)return a;try{return yield a.json()}catch(l){yield xs(l)}})}function ee(i){var e;let t=null;ao(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=bs(i.expires_in)));let r=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:r},error:null}}function Pr(i){let e=ee(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=i.weak_password),e}function N(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function ks(i){return{data:i,error:null}}function Ds(i){let{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:n}=i,o=io(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:n},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Os(i){return i}function ao(i){return i.access_token&&i.refresh_token&&i.expires_in}var lo=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(i);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(i,r[s])&&(t[r[s]]=i[r[s]]);return t},Pe=class{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Rt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(e,t="global"){return h(this,null,function*(){try{return yield m(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(g(r))return{data:null,error:r};throw r}})}inviteUserByEmail(r){return h(this,arguments,function*(e,t={}){try{return yield m(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:N})}catch(s){if(g(s))return{data:{user:null},error:s};throw s}})}generateLink(e){return h(this,null,function*(){try{let{options:t}=e,r=lo(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),yield m(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Ds,redirectTo:t?.redirectTo})}catch(t){if(g(t))return{data:{properties:null,user:null},error:t};throw t}})}createUser(e){return h(this,null,function*(){try{return yield m(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:N})}catch(t){if(g(t))return{data:{user:null},error:t};throw t}})}listUsers(e){return h(this,null,function*(){var t,r,s,n,o,a,l;try{let c={nextPage:null,lastPage:0,total:0},u=yield m(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(n=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:""},xform:Os});if(u.error)throw u.error;let d=yield u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(y=>{let _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=_}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(g(c))return{data:{users:[]},error:c};throw c}})}getUserById(e){return h(this,null,function*(){try{return yield m(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:N})}catch(t){if(g(t))return{data:{user:null},error:t};throw t}})}updateUserById(e,t){return h(this,null,function*(){try{return yield m(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:N})}catch(r){if(g(r))return{data:{user:null},error:r};throw r}})}deleteUser(e,t=!1){return h(this,null,function*(){try{return yield m(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:N})}catch(r){if(g(r))return{data:{user:null},error:r};throw r}})}_listFactors(e){return h(this,null,function*(){try{let{data:t,error:r}=yield m(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(g(t))return{data:null,error:t};throw t}})}_deleteFactor(e){return h(this,null,function*(){try{return{data:yield m(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(g(t))return{data:null,error:t};throw t}})}};var Bt="2.61.0";var Ts="http://localhost:9999",Ps="supabase.auth.token";var Vs={"X-Client-Info":`gotrue-js/${Bt}`},Vr=10;var Is={getItem:i=>X()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{X()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{X()&&globalThis.localStorage.removeItem(i)}};function Ir(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}function js(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var co={debug:!!(globalThis&&X()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},Gt=class extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}};js();var uo={url:Ts,storageKey:Ps,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Vs,flowType:"implicit",debug:!1},nt=30*1e3,Ms=3;function ho(i,e,t){return h(this,null,function*(){return yield t()})}var jr=(()=>{class i{constructor(t){var r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=i.nextInstanceID,i.nextInstanceID+=1,this.instanceID>0&&M()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let s=Object.assign(Object.assign({},uo),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Pe({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Rt(s.fetch),this.lock=s.lock||ho,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:X()?this.storage=Is:(this.memoryStorage={},this.storage=Ir(this.memoryStorage)):(this.memoryStorage={},this.storage=Ir(this.memoryStorage)),M()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",n=>h(this,null,function*(){this._debug("received broadcast notification from other tab or client",n),yield this._notifyAllSubscribers(n.data.event,n.data.session,!1)}))}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Bt}) ${new Date().toISOString()}`,...t),this}initialize(){return h(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=h(this,null,function*(){return yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return h(this,null,function*(){try{let t=M()?yield this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:r,error:s}=yield this._getSessionFromURL(t);if(s)return this._debug("#_initialize()","error detecting session from URL",s),s?.message==="Identity is already linked"||s?.message==="Identity is already linked to another user"?{error:s}:(yield this._removeSession(),{error:s});let{session:n,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",o),yield this._saveSession(n),setTimeout(()=>h(this,null,function*(){o==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",n):yield this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return g(t)?{error:t}:{error:new ke("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signUp(t){return h(this,null,function*(){var r,s,n;try{yield this._removeSession();let o;if("email"in t){let{email:d,password:p,options:f}=t,y=null,_=null;if(this.flowType==="pkce"){let v=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,v),y=yield de(v),_=v===y?"plain":"s256"}o=yield m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:p,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:y,code_challenge_method:_},xform:ee})}else if("phone"in t){let{phone:d,password:p,options:f}=t;o=yield m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:ee})}else throw new fe("You must provide either an email or phone number and a password");let{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(g(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(t){return h(this,null,function*(){try{yield this._removeSession();let r;if("email"in t){let{email:o,password:a,options:l}=t;r=yield m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Pr})}else if("phone"in t){let{phone:o,password:a,options:l}=t;r=yield m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Pr})}else throw new fe("You must provide either an email or phone number and a password");let{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new De}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){return h(this,null,function*(){var r,s,n,o;return yield this._removeSession(),yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(t){return h(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return this._exchangeCodeForSession(t)}))})}_exchangeCodeForSession(t){return h(this,null,function*(){let r=yield rt(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/"),{data:o,error:a}=yield m(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:ee});return yield $t(this.storage,`${this.storageKey}-code-verifier`),a?{data:{user:null,session:null,redirectType:null},error:a}:!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new De}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:a})})}signInWithIdToken(t){return h(this,null,function*(){yield this._removeSession();try{let{options:r,provider:s,token:n,access_token:o,nonce:a}=t,l=yield m(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:ee}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new De}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){return h(this,null,function*(){var r,s,n,o,a;try{if(yield this._removeSession(),"email"in t){let{email:l,options:c}=t,u=null,d=null;if(this.flowType==="pkce"){let f=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,f),u=yield de(f),d=f===u?"plain":"s256"}let{error:p}=yield m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in t){let{phone:l,options:c}=t,{data:u,error:d}=yield m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:d}}throw new fe("You must provide either an email or phone number.")}catch(l){if(g(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(t){return h(this,null,function*(){var r,s;try{t.type!=="email_change"&&t.type!=="phone_change"&&(yield this._removeSession());let n,o;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);let{data:a,error:l}=yield m(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:ee});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,u=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(g(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithSSO(t){return h(this,null,function*(){var r,s,n;try{yield this._removeSession();let o=null,a=null;if(this.flowType==="pkce"){let l=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,l),o=yield de(l),a=l===o?"plain":"s256"}return yield m(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:ks})}catch(o){if(g(o))return{data:null,error:o};throw o}})}reauthenticate(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return h(this,null,function*(){try{return yield this._useSession(t=>h(this,null,function*(){let{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new z;let{error:n}=yield m(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}}))}catch(t){if(g(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return h(this,null,function*(){try{t.type!="email_change"&&t.type!="phone_change"&&(yield this._removeSession());let r=`${this.url}/resend`;if("email"in t){let{email:s,type:n,options:o}=t,{error:a}=yield m(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){let{phone:s,type:n,options:o}=t,{data:a,error:l}=yield m(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new fe("You must provide either an email or phone number and a type")}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return h(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return this._useSession(t=>h(this,null,function*(){return t}))}))})}_acquireLock(t,r){return h(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){let s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=h(this,null,function*(){return yield s,yield r()});return this.pendingInLock.push(h(this,null,function*(){try{yield n}catch{}})),n}return yield this.lock(`lock:${this.storageKey}`,t,()=>h(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let s=r();for(this.pendingInLock.push(h(this,null,function*(){try{yield s}catch{}})),yield s;this.pendingInLock.length;){let n=[...this.pendingInLock];yield Promise.all(n),this.pendingInLock.splice(0,n.length)}return yield s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return h(this,null,function*(){this._debug("#_useSession","begin");try{let r=yield this.__loadSession();return yield t(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return h(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null,r=yield rt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};let s=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s)return{data:{session:t},error:null};let{session:n,error:o}=yield this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return h(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return h(this,null,function*(){try{return t?yield m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:N}):yield this._useSession(r=>h(this,null,function*(){var s,n;let{data:o,error:a}=r;if(a)throw a;return yield m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0,xform:N})}))}catch(r){if(g(r))return{data:{user:null},error:r};throw r}})}updateUser(s){return h(this,arguments,function*(t,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._updateUser(t,r)}))})}_updateUser(s){return h(this,arguments,function*(t,r={}){try{return yield this._useSession(n=>h(this,null,function*(){let{data:o,error:a}=n;if(a)throw a;if(!o.session)throw new z;let l=o.session,c=null,u=null;if(this.flowType==="pkce"&&t.email!=null){let f=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,f),c=yield de(f),u=f===c?"plain":"s256"}let{data:d,error:p}=yield m(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:u}),jwt:l.access_token,xform:N});if(p)throw p;return l.user=d.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(n){if(g(n))return{data:{user:null},error:n};throw n}})}_decodeJWT(t){return Tr(t)}setSession(t){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return h(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new z;let r=Date.now()/1e3,s=r,n=!0,o=null,a=Tr(t.access_token);if(a.exp&&(s=a.exp,n=s<=r),n){let{session:l,error:c}=yield this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{let{data:l,error:c}=yield this._getUser(t.access_token);if(c)throw c;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(g(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;if(!t){let{data:a,error:l}=r;if(l)throw l;t=(s=a.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new z;let{session:n,error:o}=yield this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(g(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(t){return h(this,null,function*(){try{if(!M())throw new pe("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new pe("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new st("Not a valid PKCE flow url.");let r=Ft(window.location.href);if(t){if(!r.code)throw new st("No code detected.");let{data:L,error:I}=yield this._exchangeCodeForSession(r.code);if(I)throw I;let D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:L.session,redirectType:null},error:null}}if(r.error||r.error_description||r.error_code)throw new pe(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});let{provider_token:s,provider_refresh_token:n,access_token:o,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=r;if(!o||!l||!a||!u)throw new pe("No session defined in URL");let d=Math.round(Date.now()/1e3),p=parseInt(l),f=d+p;c&&(f=parseInt(c));let y=f-d;y*1e3<=nt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${p}s`);let _=f-p;d-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,d):d-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",_,f,d);let{data:v,error:S}=yield this._getUser(o);if(S)throw S;let U={provider_token:s,provider_refresh_token:n,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:U,redirectType:r.type},error:null}}catch(r){if(g(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantFlow(){let t=Ft(window.location.href);return!!(M()&&(t.access_token||t.error_description))}_isPKCEFlow(){return h(this,null,function*(){let t=Ft(window.location.href),r=yield rt(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)})}signOut(){return h(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return h(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;if(o)return{error:o};let a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){let{error:l}=yield this.admin.signOut(a,t);if(l&&!(Ss(l)&&(l.status===404||l.status===401)))return{error:l}}return t!=="others"&&(yield this._removeSession(),yield $t(this.storage,`${this.storageKey}-code-verifier`),yield this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))})}onAuthStateChange(t){let r=ws(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),h(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:s}}}_emitInitialSession(t){return h(this,null,function*(){return yield this._useSession(r=>h(this,null,function*(){var s,n;try{let{data:{session:o},error:a}=r;if(a)throw a;yield(s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){yield(n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}}))})}resetPasswordForEmail(s){return h(this,arguments,function*(t,r={}){let n=null,o=null;if(this.flowType==="pkce"){let a=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,`${a}/PASSWORD_RECOVERY`),n=yield de(a),o=a===n?"plain":"s256"}try{return yield m(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(g(a))return{data:null,error:a};throw a}})}getUserIdentities(){return h(this,null,function*(){var t;try{let{data:r,error:s}=yield this.getUser();if(s)throw s;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(g(r))return{data:null,error:r};throw r}})}linkIdentity(t){return h(this,null,function*(){var r;try{let{data:s,error:n}=yield this._useSession(o=>h(this,null,function*(){var a,l,c,u,d;let{data:p,error:f}=o;if(f)throw f;let y=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield m(this.fetch,"GET",y,{headers:this.headers,jwt:(d=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})}));if(n)throw n;return M()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:t.provider,url:s?.url},error:null}}catch(s){if(g(s))return{data:{provider:t.provider,url:null},error:s};throw s}})}unlinkIdentity(t){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s,n;let{data:o,error:a}=r;if(a)throw a;return yield m(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_refreshAccessToken(t){return h(this,null,function*(){let r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{let s=Date.now();return yield As(n=>h(this,null,function*(){return yield Es(n*200),this._debug(r,"refreshing attempt",n),yield m(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ee})}),(n,o,a)=>a&&a.error&&Lt(a.error)&&Date.now()+(n+1)*200-s<nt)}catch(s){if(this._debug(r,"error",s),g(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return h(this,null,function*(){let s=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),M()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}})}_recoverAndRefresh(){return h(this,null,function*(){var t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let s=yield rt(this.storage,this.storageKey);if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&(yield this._removeSession());return}let n=Math.round(Date.now()/1e3),o=((t=s.expires_at)!==null&&t!==void 0?t:1/0)<n+Vr;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${Vr}s`),o){if(this.autoRefreshToken&&s.refresh_token){let{error:a}=yield this._callRefreshToken(s.refresh_token);a&&(console.error(a),Lt(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}})}_callRefreshToken(t){return h(this,null,function*(){var r,s;if(!t)throw new z;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new tt;let{data:o,error:a}=yield this._refreshAccessToken(t);if(a)throw a;if(!o.session)throw new z;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),g(o)){let a={session:null,error:o};return Lt(o)||(yield this._removeSession(),yield this._notifyAllSubscribers("SIGNED_OUT",null)),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}})}_notifyAllSubscribers(t,r,s=!0){return h(this,null,function*(){let n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(l=>h(this,null,function*(){try{yield l.callback(t,r)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}})}_saveSession(t){return h(this,null,function*(){this._debug("#_saveSession()",t),yield Z(this.storage,this.storageKey,t)})}_removeSession(){return h(this,null,function*(){this._debug("#_removeSession()"),yield $t(this.storage,this.storageKey)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&M()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return h(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let t=setInterval(()=>this._autoRefreshTokenTick(),nt);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>h(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return h(this,null,function*(){this._debug("#_stopAutoRefresh()");let t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return h(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>h(this,null,function*(){try{let t=Date.now();try{return yield this._useSession(r=>h(this,null,function*(){let{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((s.expires_at*1e3-t)/nt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${nt}ms, refresh threshold is ${Ms} ticks`),n<=Ms&&(yield this._callRefreshToken(s.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof Gt)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return h(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!M()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>h(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return h(this,null,function*(){let r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r,s){return h(this,null,function*(){let n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){let o=he();yield Z(this.storage,`${this.storageKey}-code-verifier`,o);let a=yield de(o),l=o===a?"plain":"s256";this._debug("PKCE","code verifier",`${o.substring(0,5)}...`,"code challenge",a,"method",l);let c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(c.toString())}if(s?.queryParams){let o=new URLSearchParams(s.queryParams);n.push(o.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`})}_unenroll(t){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;return o?{data:null,error:o}:yield m(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_enroll(t){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s,n;let{data:o,error:a}=r;if(a)return{data:null,error:a};let{data:l,error:c}=yield m(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(!((n=l?.totp)===null||n===void 0)&&n.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})}))}catch(r){if(g(r))return{data:null,error:r};throw r}})}_verify(t){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;if(o)return{data:null,error:o};let{data:a,error:l}=yield m(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})}))}catch(r){if(g(r))return{data:null,error:r};throw r}}))})}_challenge(t){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var s;let{data:n,error:o}=r;return o?{data:null,error:o}:yield m(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})}))}catch(r){if(g(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(t){return h(this,null,function*(){let{data:r,error:s}=yield this._challenge({factorId:t.factorId});return s?{data:null,error:s}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return h(this,null,function*(){let{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};let s=t?.factors||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:s,totp:n},error:null}})}_getAuthenticatorAssuranceLevel(){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){return yield this._useSession(t=>h(this,null,function*(){var r,s;let{data:{session:n},error:o}=t;if(o)return{data:null,error:o};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let a=this._decodeJWT(n.access_token),l=null;a.aal&&(l=a.aal);let c=l;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");let d=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}))})}}return i.nextInstanceID=0,i})();var fo=jr,Mr=fo;var Ht=class extends Mr{constructor(e){super(e)}};var po=function(i,e,t,r){function s(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):s(u.value).then(a,l)}c((r=r.apply(i,e||[])).next())})},qt=class{constructor(e,t,r){var s,n,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");let a=vs(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;let l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:ps,realtime:ms,auth:Object.assign(Object.assign({},gs),{storageKey:l}),global:fs},u=ys(r??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=u.global.headers)!==null&&n!==void 0?n:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=_s(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},u.realtime)),this.rest=new es(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Le(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ze(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return po(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:n,flowType:o,lock:a,debug:l},c,u){var d;let p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ht({url:this.authUrl,headers:Object.assign(Object.assign({},p),c),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:(d="Authorization"in this.headers)!==null&&d!==void 0?d:!1})}_initRealtimeClient(e){return new Ye(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Fs=(i,e,t)=>new qt(i,e,t);var Fr={production:!0,SUPABASE_URL:"https://ufhmdprofsovzwxkooph.supabase.co",SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVmaG1kcHJvZnNvdnp3eGtvb3BoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjU1ODM0NjQsImV4cCI6MjA0MTE1OTQ2NH0.XAtRXfJZEnvkf5c-gNNbIohrPNgUFZUQxOLi4MbG7s0"};var zt=class i{supabaseClient;constructor(){this.supabaseClient=Fs(Fr.SUPABASE_URL,Fr.SUPABASE_KEY)}getClient(){return this.supabaseClient}signUp(e){return this.supabaseClient.auth.signUp(e)}logIn(e){return this.supabaseClient.auth.signInWithPassword(e)}signOut(){return this.supabaseClient.auth.signOut()}session(){return this.supabaseClient.auth.getSession()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"})};var Wt=class i{constructor(e){this.supaBaseService=e;this.supaBaseClient=e.getClient()}supaBaseClient;state=ne({pregunta:void 0,loading:!1,error:!1});preguntasSignalComputed=H(()=>this.state().pregunta);loadingSignalComputed=H(()=>this.state().loading);errorSignalComputed=H(()=>this.state().error);getUserQuestion(e){return h(this,null,function*(){try{this.state.update(r=>A(E({},r),{loading:!0}));let t=yield this.supaBaseClient.from("preguntas").select().eq("setPreguntas",e).returns();t.status==200&&this.state.update(r=>A(E({},r),{pregunta:t.data}))}catch{this.state.update(r=>A(E({},r),{error:!0}))}finally{this.state.update(t=>A(E({},t),{loading:!1}))}})}insertNote(e){return h(this,null,function*(){console.log(e);try{let t=yield this.supaBaseClient.from("respuestasUsuarioEneagrama").insert({created_at:new Date,setDePreguntas:e.setDePreguntas,respuesta1:e.respuesta1,respuesta2:e.respuesta2,respuesta3:e.respuesta3,respuesta4:e.respuesta4,respuesta5:e.respuesta5,respuesta6:e.respuesta6,respuesta7:e.respuesta7,respuesta8:e.respuesta8,respuesta9:e.respuesta9,respuesta10:e.respuesta10,idUsuario:"5cc19f1f-d16e-4151-8cf3-1ba4c25de359"});return this.responseTemplate(t)}catch(t){return console.error("Unexpected error:",t),{success:!1,error:t}}})}responseTemplate(e){return e.error?{success:!1,error:e.error}:{success:!0,data:e.data}}static \u0275fac=function(t){return new(t||i)(Lr(zt))};static \u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"})};var _o=(i,e)=>e.id,vo=()=>[vt,hr,Pi,fr];function yo(i,e){if(i&1&&(G(0,"label",6),J(1),j(),G(2,"div",7)(3,"div")(4,"label",8),J(5),j(),Xt(6,"input",9),j(),G(7,"div")(8,"label",8),J(9),j(),Xt(10,"input",10),j()()),i&2){let t=e.$implicit,r=e.$index;R(),ct(" ",t.idPregunta+".- "+t.pregunta,""),R(3),oe("for","respuesta",r+1,"_a"),R(),ct(" ",t.respuesta1,""),R(),oe("id","respuesta",r+1,"_a"),oe("formControlName","pregunta",r+1,""),R(2),oe("for","respuesta",r,"_b"),R(),ct(" ",t.respuesta2,""),R(),oe("id","respuesta",r+1,"_b"),oe("formControlName","pregunta",r+1,"")}}function bo(i,e){i&1&&J(0," Error Cargando Pagina ")}function wo(i,e){if(i&1&&(G(0,"div",3),Qr(1,yo,11,15,null,null,_o,!1,bo,1,0),j(),G(4,"div",4)(5,"button",5),J(6,"Confirmar "),j()()),i&2){let t=Xr();R(),Yr(t.ordernarIds())}}function Co(i,e){i&1&&(G(0,"p"),J(1,"Estoy cargando panita"),j())}var Jt=class i{constructor(e,t,r){this.formBuilder=e;this.preguntasService=t;this.route=r;this.formularioPreguntas=this.formBuilder.group({pregunta1:new x(null,T.required),pregunta2:new x(null,T.required),pregunta3:new x(null,T.required),pregunta4:new x(null,T.required),pregunta5:new x(null,T.required),pregunta6:new x(null,T.required),pregunta7:new x(null,T.required),pregunta8:new x(null,T.required),pregunta9:new x(null,T.required),pregunta10:new x(null,T.required)})}formularioPreguntas;setQuestion="";ngOnInit(){this.route.params.subscribe(e=>{this.setQuestion="set"+e.id}),this.preguntasService.getUserQuestion(this.setQuestion)}submit(){return h(this,null,function*(){if(this.formularioPreguntas.invalid){alert("Completa todas las preguntas");return}let e=yield this.preguntasService.insertNote({setDePreguntas:"set1",respuesta1:this.formularioPreguntas.value.pregunta1,respuesta2:this.formularioPreguntas.value.pregunta2,respuesta3:this.formularioPreguntas.value.pregunta3,respuesta4:this.formularioPreguntas.value.pregunta4,respuesta5:this.formularioPreguntas.value.pregunta5,respuesta6:this.formularioPreguntas.value.pregunta6,respuesta7:this.formularioPreguntas.value.pregunta7,respuesta8:this.formularioPreguntas.value.pregunta8,respuesta9:this.formularioPreguntas.value.pregunta9,respuesta10:this.formularioPreguntas.value.pregunta10});console.log(e)})}ordernarIds(){return this.preguntasService.preguntasSignalComputed().sort((e,t)=>e.id-t.id)}static \u0275fac=function(t){return new(t||i)(w($i),w(Wt),w(ri))};static \u0275cmp=Gr({type:i,selectors:[["app-cuestionario"]],standalone:!0,features:[Zr],decls:8,vars:1,consts:[[1,"bg-background","w-3/4","p-4","mx-auto","mt-8","rounded-2xl"],[1,"font-bold","text-xl","text-center"],[3,"ngSubmit","formGroup"],[1,"flex","flex-col","mx-auto"],[1,"flex","w-full","justify-end"],["type","submit",1,"focus:outline-none","text-white","bg-primary-700","hover:bg-primary-700","focus:ring-4","focus:ring-primary-100","font-medium","rounded-lg","text-sm","px-5","py-2.5","me-2","mb-2","dark:bg-primary-400","dark:hover:bg-primary-700","dark:focus:ring-primary-700","mt-5"],[1,"font-bold","text-center","text-xl","mt-8","mb-5"],[1,"flex","justify-between"],[3,"for"],["type","radio","value","0",1,"ms-5","before:content['']","peer","relative","h-5","w-5","cursor-pointer","appearance-none","rounded-md","border","border-blue-gray-200","transition-all","before:absolute","before:top-2/4","before:left-2/4","before:block","before:h-12","before:w-12","before:-translate-y-2/4","before:-translate-x-2/4","before:rounded-full","before:bg-blue-gray-500","before:opacity-0","before:transition-opacity","checked:border-pink-500","checked:bg-pink-500","checked:before:bg-pink-500","hover:before:opacity-10",3,"id","formControlName"],["type","radio","value","1",1,"ms-5","before:content['']","peer","relative","h-5","w-5","cursor-pointer","appearance-none","rounded-md","border","border-blue-gray-200","transition-all","before:absolute","before:top-2/4","before:left-2/4","before:block","before:h-12","before:w-12","before:-translate-y-2/4","before:-translate-x-2/4","before:rounded-full","before:bg-blue-gray-500","before:opacity-0","before:transition-opacity","checked:border-pink-500","checked:bg-pink-500","checked:before:bg-pink-500","hover:before:opacity-10",3,"id","formControlName"]],template:function(t,r){t&1&&(G(0,"section",0)(1,"h1",1),J(2,"Cuestionario 1"),j(),G(3,"form",2),ge("ngSubmit",function(){return r.submit()}),zr(4,wo,7,1)(5,Co,2,0),Wr(6,4,vo,null,5),Jr(500),j()()),t&2&&(R(3),Kr("formGroup",r.formularioPreguntas))},dependencies:[Ni,Fi,Vi,dr]})};var Eo=[{path:"preguntas/:id",component:Jt}],Kt=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=se({type:i});static \u0275inj=re({imports:[er.forChild(Eo),er]})};var Rs=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=se({type:i});static \u0275inj=re({imports:[ti,Kt]})};export{Rs as PreguntasModule};
